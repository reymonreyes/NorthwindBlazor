@page "/customerorders/create"
@page "/customerorders/{id:int}"
@using Northwind.Core.Interfaces.Services
@inherits PageBase

<MudToolBar>
    <MudText><b>Customer Order</b></MudText>
</MudToolBar>
<MudDivider DividerType="DividerType.FullWidth" Light="true" />
<MudGrid Class="pt-3" Spacing="3">
    <MudItem sm="12" md="6" lg="6" Style="position: relative;">
        <MudOverlay Visible="_isCustomerOrderFormOverlayVisible" Absolute="true" DarkBackground="true">
            <MudStack>
                <MudText Style="@($"color:{Colors.Shades.White};")">Updating</MudText>
                <MudProgressCircular Class="align-self-center" Color="Color.Primary" Indeterminate="true" />
            </MudStack>
        </MudOverlay>
        @if (_customerOrder is not null)
        {
            <MudForm @ref="_customerOrderForm" @bind-IsValid="_isCustomerOrderFormValid" Model="_customerOrder" Validation="(_customerOrderValidator.ValidateValue)">
                <MudGrid>
                    <MudItem xs="12" sm="12" md="12" lg="12">
                        <MudPaper Elevation="1" Square="true">
                            <MudToolBar>
                                <MudText>Order # <b>@_customerOrder.Id</b></MudText>
                                <MudSpacer />
                                <MudButton OnClick="Save" Color="Color.Primary" Variant="Variant.Filled" Size="Size.Small" Class="mr-1">Save</MudButton>
                            </MudToolBar>
                        </MudPaper>
                    </MudItem>
                    <MudItem xs="12" sm="12" md="12" lg="12">
                        @if (_errors.Count > 0)
                        {
                            <MudAlert Severity="MudBlazor.Severity.Error">
                                @foreach (var error in _errors)
                                {
                                    <MudText>@error</MudText>
                                }
                            </MudAlert>
                        }
                    </MudItem>
                <MudItem xs="12" sm="12" md="12" lg="12">
                    <MudAutocomplete @bind-Value="_customerOrder.Customer" Label="Customer" SearchFunc="@FindCustomer" ToStringFunc="@(x => x == null ? null : $"{x.Name}")" For="@(() => _customerOrder.Customer)"
                        ResetValueOnEmptyText="true" Immediate="true" ProgressIndicatorColor="Color.Info" Variant="Variant.Outlined" Margin="Margin.Dense"></MudAutocomplete>
                </MudItem>
                <MudItem md="4" lg="4">
                    <MudDatePicker @bind-Date="_customerOrder.OrderDate" For="@(() => _customerOrder.OrderDate)" Label="Order Date" Editable="true" Mask="@(new DateMask("0000-00-00"))" DateFormat="yyyy-MM-dd" />
                </MudItem>
                <MudItem md="4" lg="4">
                    <MudDatePicker @bind-Date="_customerOrder.DueDate" For="@(() => _customerOrder.DueDate)" Label="Due Date" />
                </MudItem>
                <MudItem md="4" lg="4">
                    <MudDatePicker @bind-Date="_customerOrder.ShipDate" For="@(() => _customerOrder.ShipDate)" Label="Ship Date" />
                </MudItem>
                <MudItem md="6" lg="6">
                    <MudTextField @bind-Value="_customerOrder.ShipperId" For="@(() => _customerOrder.ShipperId)" Label="Shipper"></MudTextField>
                </MudItem>
                <MudItem md="6" lg="6">
                    <MudTextField @bind-Value="_customerOrder.ShipTo" For="@(() => _customerOrder.ShipTo)" Label="Ship To"></MudTextField>
                </MudItem>
                <MudItem xs="12" sm="12" md="12" lg="12">
                    <MudTextField @bind-Value="_customerOrder.Notes" For="@(() => _customerOrder.Notes)" Label="Notes" Lines="3"></MudTextField>
                </MudItem>
            </MudGrid>
        </MudForm>
        }
    </MudItem>
    <MudItem sm="12" md="6" lg="6">

    </MudItem>
</MudGrid>